import{_ as i,c as s,o as a,a2 as t}from"./chunks/framework.BOOijfbL.js";const c=JSON.parse('{"title":"New feature: Compressing rotated log files","description":"Learn how logga saves disk space by compressing rotated log files.","frontmatter":{"outline":"deep","title":"New feature: Compressing rotated log files","description":"Learn how logga saves disk space by compressing rotated log files."},"headers":[],"relativePath":"articles/compressing-rotated-log-files.md","filePath":"articles/compressing-rotated-log-files.md"}'),l={name:"articles/compressing-rotated-log-files.md"},n=t(`<h1 id="new-feature-compressing-rotated-log-files" tabindex="-1">✨ New feature: Compressing rotated log files <a class="header-anchor" href="#new-feature-compressing-rotated-log-files" aria-label="Permalink to &quot;:sparkles: New feature: Compressing rotated log files&quot;">​</a></h1><p>One requested feature for logga was to compress rotated log files to save disk space. Well, we have good news: version <a href="https://storage.getlogga.com/logga-client-1.1.1.pkg" target="_blank" rel="noreferrer">1.1.1</a> brings you log compression!</p><p>To start to use the feature, add the <code>compressArchives: true</code> to the <code>config.yaml</code> configuration file, or update your <a href="https://docs.getlogga.com/usage/configuration#configuration-with-custom-mdm-configuration-profile" target="_blank" rel="noreferrer">MDM Configuration Profile</a>.</p><h2 id="how-log-compression-works" tabindex="-1">How log compression works? <a class="header-anchor" href="#how-log-compression-works" aria-label="Permalink to &quot;How log compression works?&quot;">​</a></h2><p>Log rotation is controlled by the <code>maxLogFileCount</code> and <code>maxLogFileSize</code> configuration keys.<br><code>maxLogFileCount</code> tells logga how many rotated log files to keep at once. <code>maxLogFileSize</code> signals logga when to rotate the current log file: when the file size surpasses the configured bytes, the file gets rotated.</p><p>Initially, logs get written into <code>audit.log</code> (or <code>access.log</code>) file. A rotation event is shown in the following timeline:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># maxLogFileCount: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] logga -&gt; audit.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. maxLogFileSize reached</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">rotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] logga -&gt; audit.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. maxLogFileSize reached again</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">rotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">rotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] logga -&gt; audit.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. maxLogFileSize reached again</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">rotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">rotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] logga -&gt; audit.log</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...</span></span></code></pre></div><p>When log compression is turned on (<code>compressArchives: true</code>), the rotation rules still take effect, but the files will be a bit different.</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># maxLogFileCount: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] logga -&gt; audit.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. maxLogFileSize reached</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">rotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|-&gt; [</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">compression</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1710807884</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.gzip</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] logga -&gt; audit.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. maxLogFileSize reached again</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">no</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1710807884</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.gzip</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">rotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|-&gt; [</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">compression</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1710808030</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.gzip</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] logga -&gt; audit.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. maxLogFileSize reached again</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1710807884</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.gzip</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">no</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"> action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1710808030</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.gzip</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">rotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">|-&gt; [</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">compression</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -&gt; audit.log.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1710808102</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.gzip</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">logging</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] logga -&gt; audit.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...</span></span></code></pre></div><p>If log compression is turned <strong>on</strong>, it makes sense to bump <code>maxLogFileCount</code> to a high number, like <strong>50-100</strong>, so compressed files are kept and not frequently rotated.</p><p>We hope this feature will be a useful addition to your audit-logging toolchain! If you need help with setting up logga, <a href="mailto:peter@getlogga.com">contact support</a> or open an issue on <a href="https://github.com/logga-app/logga-public/issues/new">Github</a>.</p>`,11),e=[n];function h(k,p,o,g,r,E){return a(),s("div",null,e)}const y=i(l,[["render",h]]);export{c as __pageData,y as default};
